<!DOCTYPE html>
<html>
  <head>
    <title>Crossroads schematization</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <!-- link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
    integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
    crossorigin=""></script>

    <script src="//d3js.org/d3.v4.min.js"></script>
    <script src="//npmcdn.com/geotiff@0.3.6/dist/geotiff.js"></script> 
    <script src="//cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js"></script>

    <script src="static/js/leaflet.canvaslayer.field.js"></script-->

    <!-- see https://openlayers.org/download/ for legacy build -->
    <script src="static/js/ol.js"></script>
    <link rel="stylesheet" href="static/css/ol.css">
    <script src="https://cdn.jsdelivr.net/npm/geotiff"></script>
      
    <!-- https://bjkronenfeld.wordpress.com/2019/09/10/getting-openlayers-5-examples-to-work-without-node-js/ -->
    <!-- https://openlayers.org/download/ 
    
    <script src="https://cdn.jsdelivr.net/npm/ol@v7.1.0/dist/ol.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.1.0/ol.css">

    The full build of the library does not include all dependencies: the geotiff and ol-mapbox-style packages are omitted. If you use these, you'll need to add additional script tags. 

    https://github.com/geotiffjs/geotiff.js:
    <script src="https://cdn.jsdelivr.net/npm/geotiff"></script>

-->
  
    <link rel="stylesheet" href="static/css/index.css">
    <script src="static/js/fetchTimeout.js"></script>
    <script src="static/js/index.js"></script>
  </head>
  <body onload=init()>
    <div id="map" class="map" tabindex="0" autofocus></div>
    <div id="content">
      <div id="text">
        <p>Cliquez au centre d'un carrefour pour en obtenir sa schématisation.</p>
      </div>
      <div>
        <fieldset>
          <legend>Affichage</legend>
        <div><span><label>Opacité</label></span>
          <input id="opacity" class="slider" type="range" name="opacity" min="0" max="1.0" value="1.0" step="0.1" disabled>
        </div>
        </fieldset>

        <a id="download_button" class="button_disabled button_large" disabled>Télécharger (geotiff)</a>
        <a id="osm_button" target="_blank" class="button button_large">Éditer dans OpenStreetMap</a>
      </div>
      <div id="advanced">
        <button id="settings_button" class="button tab selected" onclick=selectSettings()>Options</button>
        <button id="comment_button" class="button tab" onclick=selectComment()>Commentaire</button>
        <div id="comment" class="panel">
          <textarea id="comment_text" rows="4" oninput="updateSendButton(this.value)"></textarea>
          <span><button id="send_button" class="button_disabled" disabled onclick=sendComment()>Envoyer</button></span>
        </div>
        <div id="settings" class="selected_panel">
          <div id="settings_content">
            <fieldset>
            <legend>Paramètres de segmentation</legend>
            <div class="parameters">
              <div>
                <span><label>Rayon élémentaire (C0) : </label><label id="C0val">2</label></span>
                <input id="C0" class="slider" type="range" name="C0" min="0.1" max="10" value="2" step="0.1" oninput="updateSlider(this, this.value)">
              </div>
              <div>
                <span><label>Distance de fusion (C1) : </label><label id="C1val">2</label></span>
                <input id="C1" class="slider" type="range" name="C1" min="0.1" max="10" value="2" step="0.1" oninput="updateSlider(this, this.value)">
              </div>
              <div>
                <span><label>Longueur boucle de fusion (C2) : </label><label id="C2val">4</label></span>
                <input id="C2" class="slider" type="range" name="C2" min="0.1" max="8" value="4" step="0.1" oninput="updateSlider(this, this.value)">
              </div>
            </div>
            </fieldset>
            <fieldset>
              <legend>Paramètres de schématisation</legend>
              <div class="parameters">
                <div><input type="checkbox" id="ignore_pp"> <label>Les trottoirs ignorent les passages piétons</label></div>
                
                <div><input type="checkbox" id="fixed_width"> <label>Branches à largeur fixe</label></div>

                <div>
                  <span><label>Forme des tournants</label></span>
                  <div class="choix">
                    <div>
                      <input type="radio" id="bevel" name="turns" value="bevel"
                            checked>
                      <label for="bevel">chanfreins</label>
                    </div>
                    <div>
                      <input type="radio" id="straight" name="turns" value="straight">
                      <label for="straight">angles vifs</label>
                    </div>
                    <div>
                      <input type="radio" id="adjusted" name="turns" value="adjusted" checked>
                      <label for="adjusted">angles ajustés</label>
                    </div>
                  </div>
                </div>

                <div>
                  <span><label>Format de la carte</label></span>
                  <div class="choix">
                    <div>
                      <input type="radio" id="A5_landscape" name="layout" value="A5_landscape"
                            checked>
                      <label for="A5_landscape">A5 paysage</label>
                    </div>
                    <div>
                      <input type="radio" id="A5_portrait" name="layout" value="A5_portrait">
                      <label for="A5_portrait">A5 portrait</label>
                    </div>
                    <div>
                      <input type="radio" id="A4_landscape" name="layout" value="A4_landscape">
                      <label for="A4_landscape">A4 paysage</label>
                    </div>
                    <div>
                      <input type="radio" id="A4_portrait" name="layout" value="A4_portrait">
                      <label for="A4_portrait">A4 portrait</label>
                    </div>
                  </div>
                </div>
                <div>
                  <span><label>Marges (cm) autour de la carte</label></span>
                  <input type="number" id="margins" name="margins" min="0" max="10" step="0.1" value="1.0" />
                </div>
              </div>
            </fieldset>
          </div>
          <span id="settings_buttons"><button id="reload_button" class="button_disabled" disabled onclick=reloadPigeon()>Recharger</button><button id="reset_button" class="button" onclick=resetParameters()>Réinitialiser</button></span>
        </div>
      </div>
    </div>
  </body>
</html> 